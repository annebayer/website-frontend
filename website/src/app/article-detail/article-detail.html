<div class="article-detail" *ngIf="day">
  <!-- Header -->
  <header class="article-header">
    <h1>{{ day.title }}</h1>

    <div class="meta-info">
      <span class="dates">
        📅 {{ day.dateFrom | date:'dd.MM.yyyy' }}
        <span *ngIf="day.dateTo"> - {{ day.dateTo | date:'dd.MM.yyyy' }}</span>
      </span>

      <span class="highlights" *ngIf="day.Highlights">
        ⭐ {{ day.Highlights }}
      </span>
    </div>

    <!-- Teaser Bild -->
    <div class="hero-image" *ngIf="day.teaserBild">
      <img
        [src]="getImageUrl(day.teaserBild.url)"
        [alt]="day.teaserBild.alternativeText || day.title"
      />
    </div>
  </header>

  <!-- Short Description -->
  <div class="intro" *ngIf="day.descriptionShort">
    <p class="lead">{{ day.descriptionShort }}</p>
  </div>

  <!-- Main Description -->
  <div class="description" *ngIf="day.description">
    <ng-container *ngFor="let block of day.description">
      <p *ngFor="let child of block.children">{{ child.text }}</p>
    </ng-container>
  </div>

  <!-- Content Blocks -->
  <div class="content-blocks" *ngIf="day.pictures?.length">
    <ng-container *ngFor="let block of day.pictures; let i = index">

      <!-- Tip Block -->
      <div *ngIf="isTip(block)" class="tip-block">
        <p>Tip</p>
        <app-tip [tip]="block"></app-tip>
      </div>

      <!-- BILDER MIT TEXT -->
      <div class="block bilder-mit-text-block" *ngIf="isBilderMitText(block)">
        <p class="block-description" *ngIf="block.Beschreibung">
          {{ block.Beschreibung }}
        </p>

        <div class="image-grid" [class.single]="block.Bilder.length === 1">
          <div
            *ngFor="let img of block.Bilder; let j = index"
            class="image-wrapper"
            (click)="openSlider(block.Bilder, j)"
          >
            <img
              [src]="getImageUrl(img.url)"
              [alt]="img.alternativeText || day.title"
              loading="lazy"
            />
            <div class="image-overlay">
              <span class="zoom-icon">🔍</span>
            </div>
          </div>
        </div>
      </div>

      <!-- AUSFLÜGE -->
      <div class="block ausfluege-block" *ngIf="block.__component === 'shared.ausfluege'">
        <div class="block-header">
          <h2>{{ block.title }}</h2>
          <p class="subtitle" *ngIf="block.description">{{ block.description }}</p>
        </div>

        <div *ngFor="let item of block.Bilder" class="ausflug-item">
          <p class="item-description" *ngIf="item.Beschreibung">
            {{ item.Beschreibung }}
          </p>

          <div class="image-grid" [class.single]="item.Bilder.length === 1">
            <div
              *ngFor="let img of item.Bilder; let k = index"
              class="image-wrapper"
              (click)="openSlider(item.Bilder, k)"
            >
              <img
                [src]="getImageUrl(img.url)"
                [alt]="img.alternativeText || item.Beschreibung || block.title"
                loading="lazy"
              />
              <div class="image-overlay">
                <span class="zoom-icon">🔍</span>
              </div>
            </div>
          </div>
        </div>

        <div class="tip-wrapper" *ngIf="block.tip">
          <app-tip [tip]="block.tip"></app-tip>
        </div>
      </div>

    </ng-container>
  </div>

  <!-- LIGHTBOX -->
  <div class="lightbox" *ngIf="activePicture" [@fadeIn]>
    <div class="lightbox-overlay" (click)="closeSlider()"></div>
    <div class="lightbox-content">
      <button class="lightbox-close" (click)="closeSlider()" aria-label="Close">
        ×
      </button>

      <img
        [src]="getImageUrl(activePicture.url)"
        [alt]="activePicture.alternativeText || ''"
        class="lightbox-image"
      />

      <p class="lightbox-description" *ngIf="activePicture.alternativeText">
        {{ activePicture.alternativeText }}
      </p>

      <div class="lightbox-nav" *ngIf="sliderImages.length > 1">
        <button
          class="nav-btn prev"
          (click)="prevPicture()"
          aria-label="Previous"
          [disabled]="currentImageIndex === 0"
        >
          ‹
        </button>
        <span class="image-counter">
          {{ currentImageIndex + 1 }} / {{ sliderImages.length }}
        </span>
        <button
          class="nav-btn next"
          (click)="nextPicture()"
          aria-label="Next"
          [disabled]="currentImageIndex === sliderImages.length - 1"
        >
          ›
        </button>
      </div>
    </div>
  </div>
</div>
